(()=>{"use strict";class t{constructor(t,e,s,n){this.templateElement=document.querySelector(`#${t}`),this.hostElement=document.querySelector(`#${e}`);const i=document.importNode(this.templateElement.content,!0);this.element=i.firstElementChild,s&&this.element.classList.add(s),n&&(this.element.id=n),this.attach()}attach(){this.hostElement.insertAdjacentElement("beforeend",this.element)}}var e;!function(t){t[t.Active=0]="Active",t[t.Completed=1]="Completed"}(e||(e={}));class s{constructor(t,e,s,n){this.id=t,this.title=e,this.description=s,this.status=n}}class n extends class{constructor(){this.listeners=[]}addlistener(t){this.listeners.push(t)}}{constructor(){super(),this.tasks=[]}static getInstance(){return this.instance||(this.instance=new n),this.instance}addTask(t,n){const i=new s(Date.now().toString(),t,n,e.Active);this.tasks.push(i),this.runListeners()}moveTask(t,e){const s=this.tasks.find((e=>e.id===t));s&&s.status!==e&&(s.status=e,this.runListeners())}runListeners(){for(const t of this.listeners)t(this.tasks.slice())}}const i=n.getInstance();function r(t){let e=!0,s=[];if(t.required){let n=0!==t.value.length;n||s.push(`${t.field} is required`),e=e&&n}if(null!=t.minLength){let n=t.value.length>=t.minLength;n||s.push(`${t.field} should have a minimum length of ${t.minLength}`),e=e&&n}if(null!=t.maxLength){let n=t.value.length<=t.maxLength;n||s.push(`${t.field} can have a maximum length of ${t.maxLength}`),e=e&&n}return[e,s]}class a extends t{constructor(t,e){super("single-task",t,void 0,e.id),this.task=e,this.configure(),this.renderContent()}dragStartHandler(t){t.dataTransfer.setData("text/plain",this.task.id),t.dataTransfer.effectAllowed="move"}dragEndHandler(t){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler.bind(this)),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.task.title,this.element.querySelector("p").textContent=this.task.description}}class l extends t{constructor(t){super("task-list","app",t),this.type=t,this.tasks=[],this.configure(),this.renderContent()}dragOverHandler(t){t.dataTransfer&&"text/plain"===t.dataTransfer.types[0]&&t.preventDefault()}dropHandler(t){const s=t.dataTransfer.getData("text/plain");i.moveTask(s,"active"===this.type?e.Active:e.Completed)}dragLeaveHandler(t){}configure(){this.element.addEventListener("dragover",this.dragOverHandler.bind(this)),this.element.addEventListener("drop",this.dropHandler.bind(this)),this.element.addEventListener("dragleave",this.dragLeaveHandler),i.addlistener((t=>{const s=t.filter((t=>"active"===this.type?t.status===e.Active:t.status===e.Completed));this.tasks=s,this.renderTasks()}))}renderTasks(){document.querySelector(`#tasks-${this.type}`).innerHTML="";for(const t of this.tasks)new a(`tasks-${this.type}`,t)}renderContent(){this.element.querySelector("ul").id=`tasks-${this.type}`,this.element.querySelector("h2").textContent=`${this.type.toUpperCase()} TASKS`}}new class extends t{constructor(){super("header","app")}},new class extends t{constructor(){super("task-input","app"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.configure()}configure(){this.element.querySelector("form").addEventListener("submit",this.submitHandler.bind(this))}submitHandler(t){t.preventDefault();const e=this.collectInputs();if(Array.isArray(e)){const[t,s]=e;i.addTask(t,s),this.clearInputs()}}collectInputs(){const t=this.titleInputElement.value.trim(),e=this.descriptionInputElement.value.trim(),[s,n]=r({field:"title",value:t,required:!0}),[i,a]=r({field:"description",value:e,required:!0,minLength:5});if(s&&i)return[t,e];{let t=[...n,...a];alert(`${t.join(", ")}`)}}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value=""}},new l("active"),new l("completed")})();